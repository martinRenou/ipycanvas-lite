(self.webpackChunk_JUPYTERLAB_CORE_OUTPUT=self.webpackChunk_JUPYTERLAB_CORE_OUTPUT||[]).push([[1972],{62538:(e,t,s)=>{"use strict";s.d(t,{Ld:()=>d,r1:()=>h,nY:()=>r});var n=s(23205),c=s(24803),a=s(55852);const o=new Map,i="undefined"==typeof BroadcastChannel?class{constructor(e){this.room=e,this.onmessage=null,a.z((t=>t.key===e&&null!==this.onmessage&&this.onmessage({data:c.Gh(t.newValue||"")})))}postMessage(e){a.X.setItem(this.room,c.s3(c.eh(e)))}}:BroadcastChannel,l=e=>n.Yu(o,e,(()=>{const t=new Set,s=new i(e);return s.onmessage=e=>t.forEach((t=>t(e.data))),{bc:s,subs:t}})),d=(e,t)=>l(e).subs.add(t),h=(e,t)=>l(e).subs.delete(t),r=(e,t)=>{const s=l(e);s.bc.postMessage(t),s.subs.forEach((e=>e(t)))}},31955:(e,t,s)=>{"use strict";s.d(t,{M:()=>n});const n=()=>{let e=!0;return(t,s)=>{if(e){e=!1;try{t()}finally{e=!0}}else void 0!==s&&s()}}},29849:(e,t,s)=>{"use strict";s.d(t,{b:()=>c});var n=s(69600);const c=e=>n.UI(e,((e,t)=>`${encodeURIComponent(t)}=${encodeURIComponent(e)}`)).join("&")},65831:(e,t,s)=>{"use strict";s.d(t,{nw:()=>c});var n=s(94072);const c=(e,t,s)=>{switch(n.yg(e)){case 0:s(t,n.kf(e))}}},6493:(e,t,s)=>{"use strict";s.d(t,{GL:()=>d,Ag:()=>h,xq:()=>r,oy:()=>u});var n=s(23406),c=s(94072),a=s(40870),o=s(21332),i=s(75736),l=s(91985);class d extends i.y{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval((()=>{const e=a.ZG();null!==this.getLocalState()&&15e3<=e-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const t=[];this.meta.forEach(((s,n)=>{n!==this.clientID&&3e4<=e-s.lastUpdated&&this.states.has(n)&&t.push(n)})),t.length>0&&h(this,t,"timeout")}),o.GW(3e3)),e.on("destroy",(()=>{this.destroy()})),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){const t=this.clientID,s=this.meta.get(t),n=void 0===s?0:s.clock+1,c=this.states.get(t);null===e?this.states.delete(t):this.states.set(t,e),this.meta.set(t,{clock:n,lastUpdated:a.ZG()});const o=[],i=[],d=[],h=[];null===e?h.push(t):null==c?null!=e&&o.push(t):(i.push(t),l.Hi(c,e)||d.push(t)),(o.length>0||d.length>0||h.length>0)&&this.emit("change",[{added:o,updated:d,removed:h},"local"]),this.emit("update",[{added:o,updated:i,removed:h},"local"])}setLocalStateField(e,t){const s=this.getLocalState();null!==s&&this.setLocalState({...s,[e]:t})}getStates(){return this.states}}const h=(e,t,s)=>{const n=[];for(let s=0;s<t.length;s++){const c=t[s];if(e.states.has(c)){if(e.states.delete(c),c===e.clientID){const t=e.meta.get(c);e.meta.set(c,{clock:t.clock+1,lastUpdated:a.ZG()})}n.push(c)}}n.length>0&&(e.emit("change",[{added:[],updated:[],removed:n},s]),e.emit("update",[{added:[],updated:[],removed:n},s]))},r=(e,t,s=e.states)=>{const c=t.length,a=n.Mf();n.uE(a,c);for(let o=0;o<c;o++){const c=t[o],i=s.get(c)||null,l=e.meta.get(c).clock;n.uE(a,c),n.uE(a,l),n.uw(a,JSON.stringify(i))}return n._f(a)},u=(e,t,s)=>{const n=c.l1(t),o=a.ZG(),i=[],d=[],h=[],r=[],u=c.yg(n);for(let t=0;t<u;t++){const t=c.yg(n);let s=c.yg(n);const a=JSON.parse(c.kf(n)),u=e.meta.get(t),w=e.states.get(t),g=void 0===u?0:u.clock;(g<s||g===s&&null===a&&e.states.has(t))&&(null===a?t===e.clientID&&null!=e.getLocalState()?s++:e.states.delete(t):e.states.set(t,a),e.meta.set(t,{clock:s,lastUpdated:o}),void 0===u&&null!==a?i.push(t):void 0!==u&&null===a?r.push(t):null!==a&&(l.Hi(a,w)||h.push(t),d.push(t)))}(i.length>0||h.length>0||r.length>0)&&e.emit("change",[{added:i,updated:h,removed:r},s]),(i.length>0||d.length>0||r.length>0)&&e.emit("update",[{added:i,updated:d,removed:r},s])}},68078:(e,t,s)=>{"use strict";s.d(t,{Px:()=>o,_J:()=>i,K0:()=>l,lr:()=>h,zu:()=>u});var n=s(23406),c=s(94072),a=s(76961);const o=1,i=(e,t)=>{n.uE(e,0);const s=a.gJ(t);n.mP(e,s)},l=(e,t,s)=>{n.uE(e,o),n.mP(e,a.D$(t,s))},d=(e,t,s)=>{try{a.NG(t,c.HN(e),s)}catch(e){console.error("Caught error while handling a Yjs update",e)}},h=(e,t)=>{n.uE(e,2),n.mP(e,t)},r=d,u=(e,t,s,n)=>{const a=c.yg(e);switch(a){case 0:((e,t,s)=>{l(t,s,c.HN(e))})(e,t,s);break;case o:d(e,s,n);break;case 2:r(e,s,n);break;default:throw new Error("Unknown message type")}return a}},41972:(e,t,s)=>{"use strict";s.d(t,{V:()=>_});var n=s(62538),c=s(40870),a=s(23406),o=s(94072),i=s(68078),l=s(65831),d=s(6493),h=s(31955),r=s(75736),u=s(21332),w=s(29849);const g=[];g[0]=(e,t,s,n,c)=>{a.uE(e,0);const o=i.zu(t,e,s.doc,s);n&&o===i.Px&&!s.synced&&(s.synced=!0)},g[3]=(e,t,s,n,c)=>{a.uE(e,1),a.mP(e,d.xq(s.awareness,Array.from(s.awareness.getStates().keys())))},g[1]=(e,t,s,n,c)=>{d.oy(s.awareness,o.HN(t),s)},g[2]=(e,t,s,n,c)=>{l.nw(t,s.doc,f)};const f=(e,t)=>console.warn(`Permission denied to access ${e.url}.\n${t}`),m=(e,t,s)=>{const n=o.l1(t),c=a.Mf(),i=o.yg(n),l=e.messageHandlers[i];return l?l(c,n,e,s,i):console.error("Unable to compute message"),c},p=e=>{if(e.shouldConnect&&null===e.ws){const t=new e._WS(e.url);t.binaryType="arraybuffer",e.ws=t,e.wsconnecting=!0,e.wsconnected=!1,e.synced=!1,t.onmessage=s=>{e.wsLastMessageReceived=c.ZG();const n=m(e,new Uint8Array(s.data),!0);a.kE(n)>1&&t.send(a._f(n))},t.onclose=()=>{e.ws=null,e.wsconnecting=!1,e.wsconnected?(e.wsconnected=!1,e.synced=!1,d.Ag(e.awareness,Array.from(e.awareness.getStates().keys()).filter((t=>t!==e.doc.clientID)),e),e.emit("status",[{status:"disconnected"}])):e.wsUnsuccessfulReconnects++,setTimeout(p,u.VV(1200*u.mv(e.wsUnsuccessfulReconnects+1),2500),e)},t.onopen=()=>{e.wsLastMessageReceived=c.ZG(),e.wsconnecting=!1,e.wsconnected=!0,e.wsUnsuccessfulReconnects=0,e.emit("status",[{status:"connected"}]);const s=a.Mf();if(a.uE(s,0),i._J(s,e.doc),t.send(a._f(s)),null!==e.awareness.getLocalState()){const s=a.Mf();a.uE(s,1),a.mP(s,d.xq(e.awareness,[e.doc.clientID])),t.send(a._f(s))}},e.emit("status",[{status:"connecting"}])}},y=(e,t)=>{e.wsconnected&&e.ws.send(t),e.bcconnected&&e.mux((()=>{n.nY(e.bcChannel,t)}))};class _ extends r.y{constructor(e,t,s,{connect:o=!0,awareness:l=new d.GL(s),params:r={},WebSocketPolyfill:u=WebSocket,resyncInterval:f=-1}={}){for(super();"/"===e[e.length-1];)e=e.slice(0,e.length-1);const p=w.b(r);this.bcChannel=e+"/"+t,this.url=e+"/"+t+(0===p.length?"":"?"+p),this.roomname=t,this.doc=s,this._WS=u,this.awareness=l,this.wsconnected=!1,this.wsconnecting=!1,this.bcconnected=!1,this.wsUnsuccessfulReconnects=0,this.messageHandlers=g.slice(),this.mux=h.M(),this._synced=!1,this.ws=null,this.wsLastMessageReceived=0,this.shouldConnect=o,this._resyncInterval=0,f>0&&(this._resyncInterval=setInterval((()=>{if(this.ws){const e=a.Mf();a.uE(e,0),i._J(e,s),this.ws.send(a._f(e))}}),f)),this._bcSubscriber=e=>{this.mux((()=>{const t=m(this,new Uint8Array(e),!1);a.kE(t)>1&&n.nY(this.bcChannel,a._f(t))}))},this._updateHandler=(e,t)=>{if(t!==this){const t=a.Mf();a.uE(t,0),i.lr(t,e),y(this,a._f(t))}},this.doc.on("update",this._updateHandler),this._awarenessUpdateHandler=({added:e,updated:t,removed:s},n)=>{const c=e.concat(t).concat(s),o=a.Mf();a.uE(o,1),a.mP(o,d.xq(l,c)),y(this,a._f(o))},"undefined"!=typeof window&&window.addEventListener("beforeunload",(()=>{d.Ag(this.awareness,[s.clientID],"window unload")})),l.on("update",this._awarenessUpdateHandler),this._checkInterval=setInterval((()=>{this.wsconnected&&3e4<c.ZG()-this.wsLastMessageReceived&&this.ws.close()}),3e3),o&&this.connect()}get synced(){return this._synced}set synced(e){this._synced!==e&&(this._synced=e,this.emit("synced",[e]),this.emit("sync",[e]))}destroy(){0!==this._resyncInterval&&clearInterval(this._resyncInterval),clearInterval(this._checkInterval),this.disconnect(),this.awareness.off("update",this._awarenessUpdateHandler),this.doc.off("update",this._updateHandler),super.destroy()}connectBc(){this.bcconnected||(n.Ld(this.bcChannel,this._bcSubscriber),this.bcconnected=!0),this.mux((()=>{const e=a.Mf();a.uE(e,0),i._J(e,this.doc),n.nY(this.bcChannel,a._f(e));const t=a.Mf();a.uE(t,0),i.K0(t,this.doc),n.nY(this.bcChannel,a._f(t));const s=a.Mf();a.uE(s,3),n.nY(this.bcChannel,a._f(s));const c=a.Mf();a.uE(c,1),a.mP(c,d.xq(this.awareness,[this.doc.clientID])),n.nY(this.bcChannel,a._f(c))}))}disconnectBc(){const e=a.Mf();a.uE(e,1),a.mP(e,d.xq(this.awareness,[this.doc.clientID],new Map)),y(this,a._f(e)),this.bcconnected&&(n.r1(this.bcChannel,this._bcSubscriber),this.bcconnected=!1)}disconnect(){this.shouldConnect=!1,this.disconnectBc(),null!==this.ws&&this.ws.close()}connect(){this.shouldConnect=!0,this.wsconnected||null!==this.ws||(p(this),this.connectBc())}}}}]);
//# sourceMappingURL=1972.bfa1025a7f12977aaf0e.js.map